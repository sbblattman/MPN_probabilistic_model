rm: cannot remove 'part1/likelihood_tables': No such file or directory
rm: cannot remove 'part2/likelihood_tables': No such file or directory
rm: cannot remove 'part1/unexpected_gapfill_likelihoods': No such file or directory
rm: cannot remove 'part2/unexpected_gapfill_likelihoods': No such file or directory
Starting notebook execution sequence...
Input Notebook:  step1_save_pcr_swap_likelihoods.ipynb
Output Notebook: step1_save_pcr_swap_likelihoods.ipynb
Executing:   0%|          | 0/5 [00:00<?, ?cell/s]Executing notebook with kernel: python3
Executing:  20%|██        | 1/5 [00:00<00:03,  1.06cell/s]Executing:  40%|████      | 2/5 [00:03<00:06,  2.16s/cell]Executing:  80%|████████  | 4/5 [09:00<02:48, 168.94s/cell]Executing: 100%|██████████| 5/5 [09:01<00:00, 108.31s/cell]
Input Notebook:  step2_save_gapfill_frequencies_for_feature_set.ipynb
Output Notebook: step2_save_gapfill_frequencies_for_feature_set.ipynb
Executing:   0%|          | 0/7 [00:00<?, ?cell/s]Executing notebook with kernel: python3
Executing:  14%|█▍        | 1/7 [00:01<00:06,  1.09s/cell]Executing:  29%|██▊       | 2/7 [00:04<00:11,  2.24s/cell]Executing:  71%|███████▏  | 5/7 [19:04<09:05, 272.91s/cell]Executing: 100%|██████████| 7/7 [19:06<00:00, 163.72s/cell]
Input Notebook:  step3_define_feature_sets.ipynb
Output Notebook: step3_define_feature_sets.ipynb
Executing:   0%|          | 0/12 [00:00<?, ?cell/s]Executing notebook with kernel: python3
Executing:   8%|▊         | 1/12 [00:01<00:12,  1.12s/cell]Executing:  17%|█▋        | 2/12 [00:04<00:22,  2.28s/cell]Executing:  33%|███▎      | 4/12 [00:04<00:07,  1.10cell/s]Executing:  58%|█████▊    | 7/12 [00:08<00:05,  1.19s/cell]Executing: 100%|██████████| 12/12 [00:08<00:00,  1.94cell/s]Executing: 100%|██████████| 12/12 [00:09<00:00,  1.27cell/s]
Input Notebook:  step1_save_pcr_swap_likelihoods.ipynb
Output Notebook: step1_save_pcr_swap_likelihoods.ipynb
Executing:   0%|          | 0/5 [00:00<?, ?cell/s]Executing notebook with kernel: python3
Executing:  20%|██        | 1/5 [00:00<00:03,  1.06cell/s]Executing:  40%|████      | 2/5 [00:03<00:06,  2.15s/cell]Executing:  80%|████████  | 4/5 [08:57<02:47, 167.96s/cell]Executing: 100%|██████████| 5/5 [08:58<00:00, 107.69s/cell]
Input Notebook:  step2_save_gapfill_frequencies_for_feature_set.ipynb
Output Notebook: step2_save_gapfill_frequencies_for_feature_set.ipynb
Executing:   0%|          | 0/7 [00:00<?, ?cell/s]Executing notebook with kernel: python3
Executing:  14%|█▍        | 1/7 [00:00<00:05,  1.04cell/s]Executing:  29%|██▊       | 2/7 [00:04<00:12,  2.43s/cell]Executing:  71%|███████▏  | 5/7 [16:10<07:42, 231.17s/cell]Executing: 100%|██████████| 7/7 [16:11<00:00, 138.75s/cell]
Input Notebook:  step3_define_feature_sets.ipynb
Output Notebook: step3_define_feature_sets.ipynb
Executing:   0%|          | 0/12 [00:00<?, ?cell/s]Executing notebook with kernel: python3
Executing:   8%|▊         | 1/12 [00:01<00:11,  1.09s/cell]Executing:  17%|█▋        | 2/12 [00:04<00:23,  2.39s/cell]Executing:  33%|███▎      | 4/12 [00:04<00:07,  1.06cell/s]Executing:  58%|█████▊    | 7/12 [00:08<00:05,  1.11s/cell]Executing:  92%|█████████▏| 11/12 [00:08<00:00,  1.84cell/s]Executing: 100%|██████████| 12/12 [00:09<00:00,  1.32cell/s]
Input Notebook:  step4_save_gapfill_likelihoods_in_feature_set.ipynb
Output Notebook: step4_save_gapfill_likelihoods_in_feature_set.ipynb
Executing:   0%|          | 0/6 [00:00<?, ?cell/s]Executing notebook with kernel: python3
Executing:  17%|█▋        | 1/6 [00:04<00:20,  4.09s/cell]Executing:  83%|████████▎ | 5/6 [16:08<03:25, 205.90s/cell]Executing: 100%|██████████| 6/6 [16:09<00:00, 161.66s/cell]
Input Notebook:  step4_save_gapfill_likelihoods_in_feature_set.ipynb
Output Notebook: step4_save_gapfill_likelihoods_in_feature_set.ipynb
Executing:   0%|          | 0/6 [00:00<?, ?cell/s]Executing notebook with kernel: python3
Executing:  17%|█▋        | 1/6 [00:04<00:20,  4.02s/cell]Executing:  83%|████████▎ | 5/6 [13:44<02:55, 175.11s/cell]Executing: 100%|██████████| 6/6 [13:45<00:00, 137.54s/cell]
Input Notebook:  step5_get_cell_probabilities.ipynb
Output Notebook: step5_get_cell_probabilities.ipynb
Executing:   0%|          | 0/6 [00:00<?, ?cell/s]Executing notebook with kernel: python3
Executing:  17%|█▋        | 1/6 [00:01<00:05,  1.02s/cell]Executing:  33%|███▎      | 2/6 [00:04<00:10,  2.62s/cell]Executing:  83%|████████▎ | 5/6 [10:22<02:28, 148.25s/cell]Executing: 100%|██████████| 6/6 [10:24<00:00, 104.01s/cell]
Input Notebook:  step5_get_cell_probabilities.ipynb
Output Notebook: step5_get_cell_probabilities.ipynb
Executing:   0%|          | 0/6 [00:00<?, ?cell/s]Executing notebook with kernel: python3
Executing:  17%|█▋        | 1/6 [00:00<00:04,  1.03cell/s]Executing:  33%|███▎      | 2/6 [00:04<00:09,  2.40s/cell]Executing:  83%|████████▎ | 5/6 [00:25<00:05,  5.82s/cell]Executing:  83%|████████▎ | 5/6 [00:26<00:05,  5.34s/cell]
Traceback (most recent call last):
  File "/data1/lareauc/users/blattms/miniconda3/envs/gapfill_utilities/bin/papermill", line 8, in <module>
    sys.exit(papermill())
             ^^^^^^^^^^^
  File "/data1/lareauc/users/blattms/miniconda3/envs/gapfill_utilities/lib/python3.11/site-packages/click/core.py", line 1161, in __call__
    return self.main(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data1/lareauc/users/blattms/miniconda3/envs/gapfill_utilities/lib/python3.11/site-packages/click/core.py", line 1082, in main
    rv = self.invoke(ctx)
         ^^^^^^^^^^^^^^^^
  File "/data1/lareauc/users/blattms/miniconda3/envs/gapfill_utilities/lib/python3.11/site-packages/click/core.py", line 1443, in invoke
    return ctx.invoke(self.callback, **ctx.params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data1/lareauc/users/blattms/miniconda3/envs/gapfill_utilities/lib/python3.11/site-packages/click/core.py", line 788, in invoke
    return __callback(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data1/lareauc/users/blattms/miniconda3/envs/gapfill_utilities/lib/python3.11/site-packages/click/decorators.py", line 33, in new_func
    return f(get_current_context(), *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data1/lareauc/users/blattms/miniconda3/envs/gapfill_utilities/lib/python3.11/site-packages/papermill/cli.py", line 235, in papermill
    execute_notebook(
  File "/data1/lareauc/users/blattms/miniconda3/envs/gapfill_utilities/lib/python3.11/site-packages/papermill/execute.py", line 131, in execute_notebook
    raise_for_execution_errors(nb, output_path)
  File "/data1/lareauc/users/blattms/miniconda3/envs/gapfill_utilities/lib/python3.11/site-packages/papermill/execute.py", line 251, in raise_for_execution_errors
    raise error
papermill.exceptions.PapermillExecutionError: 
---------------------------------------------------------------------------
Exception encountered at "In [4]":
---------------------------------------------------------------------------
IndexError                                Traceback (most recent call last)
Cell In[4], line 41
     39 cell_genotypes = {}
     40 for probe_idx in probe_reads['probe_idx'].unique():
---> 41     cell_genotypes[probe_idx] = get_cell_genotypes(probe_idx,probe_reads, alt_genotypes.loc[alt_genotypes['probe_idx'] == probe_idx], learn_het_frac = False)
     43 all_df = pd.DataFrame()
     44 for probe_idx in cell_genotypes.keys():

Cell In[3], line 76, in get_cell_genotypes(probe_idx, probe_reads, genotype_names, fracs_1, learn_het_frac)
     74 cell_genotypes = rename_genotype_columns(cell_genotypes, genotype_names)
     75 cell_genotypes = cell_genotypes.reset_index()
---> 76 probe_name = cell_genotypes.columns[cell_genotypes.columns.str.contains('_mutated')].str.replace('_mutated','')[0]
     77 cell_genotypes[probe_name + '_high_confidence_counts'] = cell_genotypes['barcode'].map(sub_probe_reads.loc[sub_probe_reads['pcr_swap_likelihood'] < 0.1]['barcode'].value_counts().to_dict()).fillna(0)
     78 return cell_genotypes

File /data1/lareauc/users/blattms/miniconda3/envs/gapfill_utilities/lib/python3.11/site-packages/pandas/core/indexes/base.py:5389, in Index.__getitem__(self, key)
   5386 if is_integer(key) or is_float(key):
   5387     # GH#44051 exclude bool, which would return a 2d ndarray
   5388     key = com.cast_scalar_indexer(key)
-> 5389     return getitem(key)
   5391 if isinstance(key, slice):
   5392     # This case is separated from the conditional above to avoid
   5393     # pessimization com.is_bool_indexer and ndim checks.
   5394     return self._getitem_slice(key)

IndexError: index 0 is out of bounds for axis 0 with size 0

